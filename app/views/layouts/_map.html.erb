<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script>
function initialize() {
console.log("Inside initialize");
//data for pop-up info windows
var places = [ <% for i in 0..@buildings.length-2 do %>
{
  lat:    <%= @buildings[i].latitude %>,
  lng:    <%= @buildings[i].longitude %>,
  title: "<%= @buildings[i].bName %>"
},
<% end %>
{
  lat:   <%= @buildings.last.latitude %>
  lng:   <%= @buildings.last.longitude %>
  title: "<%= @buildings.last.bName %>"
}];
console.log("after erb"); 


    //map options object
    // var mapOptions = {
    //  zoom: 13,
    //  center: new google.maps.LatLng(51.47, -0.2007019),
    //  mapTypeId: google.maps.MapTypeId.ROADMAP,
    //  styles: style
    //  };
  //map initialize
  var map = new google.maps.Map(document.getElementById('map-canvas'), {
    zoom: 8,
    center: new google.maps.LatLng(34.012836,-118.495338),
    mapTypeId: google.maps.MapTypeId.ROADMAP,

  });



    //infowindows initialize
    var infowindow = new google.maps.InfoWindow();

    var marker, i;

    for (i = 0; i < places.length; i++) {  
      marker = new google.maps.Marker({
        position: new google.maps.LatLng(places[i].lat, places[i].lng),
        map: map,
        animation: google.maps.Animation.DROP
      });

      google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          infowindow.setContent(places[i].title);
          infowindow.open(map, marker);
        }
      })(marker, i));
    }
  }

  google.maps.event.addDomListener(window, 'load', initialize);

  </script>

  <div class="row"> 

    <div style="margin-bottom:30px;" id="map-canvas"></div>

  </div>

</iframe>